<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lottery</title>
    <!--Main and Tailwind CSS Files-->
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="./dist/output.css" />
    <!--Map css and js sources-->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto&display=swap"
      rel="stylesheet"
    />
    <style>
      h1,
      h2 {
        font-family: 'Montserrat', sans-serif;
      }

      p {
        font-family: 'Roboto', sans-serif;
      }
    </style>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
  </head>
  <body>
    <!--NavBar-->
    <nav class="bg-lisa">
      <div class="px-10 mx-auto">
        <div class="flex justify-between">
          <div>
            <a href="#" class="flex items-center py-4 px-3"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 mr-2 text-jennie"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"
                />
              </svg>
              <span>Flotto</span>
            </a>
          </div>
          <div class="flex items-center space-x-3">
            <a href="#map" class="py-4 px-3">Map</a>
            <a href="#table" class="py-4 px-3">Numbers</a>
            <a href="http://localhost:3000/userForm">Test Chances</a>
          </div>
        </div>
      </div>
    </nav>
    <!--Landing Page-->
    <div
      class="h-screen py-20 bg-jisoo flex items-center justify-center flex-col gap-4 text-center relative"
    >
      <h1 class="text-6xl font-bold py-3 text-white">Flotto</h1>
      <div class="lottery-balls">
        <div class="ball white-ball">
          <span class="number"></span>
        </div>
        <div class="ball white-ball">
          <span class="number"></span>
        </div>
        <div class="ball white-ball">
          <span class="number"></span>
        </div>
        <div class="ball white-ball">
          <span class="number"></span>
        </div>
        <div class="ball white-ball">
          <span class="number"></span>
        </div>
        <div class="ball red-ball">
          <span class="number"></span>
        </div>
      </div>

      <style>
        .lottery-balls {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 10vh;
          /* background-color: #f5f5f5; */
          margin-top: 5vh;
        }

        .ball {
          display: flex;
          justify-content: center;
          align-items: center;
          width: 80px;
          height: 80px;
          border-radius: 50%;
          margin: 0 10px;
          font-size: 24px;
          font-weight: bold;
          color: #fff;
        }

        .white-ball {
          background-color: #fff;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
          color: #000;
        }

        .red-ball {
          background-color: #ff0000;
          box-shadow: 0 2px 4px rgba(255, 0, 0, 0.2);
        }
      </style>

      <script>
        const balls = document.querySelectorAll('.ball')
        const numbers = document.querySelectorAll('.number')

        function generateRandomNumber() {
          return Math.floor(Math.random() * 53) + 1
        }

        function generateUniqueNumbers() {
          const uniqueNumbers = new Set()
          while (uniqueNumbers.size < 6) {
            uniqueNumbers.add(generateRandomNumber())
          }
          return Array.from(uniqueNumbers)
        }

        function updateNumbers() {
          const uniqueNumbers = generateUniqueNumbers()
          for (let i = 0; i < numbers.length; i++) {
            numbers[i].textContent = uniqueNumbers[i]
            // console.log(numbers[i])
          }
        }

        function startAnimation() {
          updateNumbers()
          setInterval(updateNumbers, 500)
        }

        startAnimation()
      </script>
      <div py-6 px-6>
        <h3 class="text-center text-white">
          <i>I came here to drop some money, dropping all my money</i>
        </h3>
        <h3 class="text-center text-white">
          <i>Drop some money, all this bread so yummy, yeah</i>
        </h3>
      </div>
      <button
        class="bg-jennie hover:bg-white text-white hover:text-jennie font-bold py-2 px-4 rounded-full"
      >
        <a href="#map">View Map</a>
      </button>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="animate-bounce w-12 h-12 bg-white rounded-full shadow p-2 absolute bottom-20"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3"
        />
      </svg>
    </div>

    <!--Next Jackpot-->
    <div class="py-12 px-10">
      <h2
        class="text-4xl text-center py-3 bg-jennie text-white rounded-full p-2"
      >
        Next Jackpot
      </h2>
      <div class="py-6 px-6 text-center">
        <p class="text-2xl" style="margin-top: 40px">
          <strong class="text-3xl text-jisoo">Date: </strong> October 7, 2023
        </p>
        <br />
        <p class="text-2xl" style="margin-top: 30px; margin-bottom: -50px" ;>
          <strong class="text-3xl text-jisoo">Prize: </strong>$8.50 Million
        </p>
      </div>
    </div>

    <!--Map-->
    <div class="py-12 px-10">
      <h2
        class="text-4xl text-center py-3 bg-jennie text-white rounded-full p-2"
      >
        Map of Winners
      </h2>
      <div class="flex items-center justify-between m-10">
        <div id="map"></div>

        <p
          class="leading-loose text-lg h-auto bg-slate-100 w-1/2 text-center rounded shadow border-slate-300 p-6"
        >
          <strong>Map use</strong><br /><br />
          This map shows where the last winning numbers were located in the
          state of Florida!
          <br />
          <br />
          <em class="text-slate-400">most common: Publix</em>
        </p>
      </div>
    </div>
    <!--Numbers Table-->
    <div class="py-12 px-10" id="table">
      <h2
        class="text-4xl text-center py-3 bg-jennie text-white rounded-full p-2"
      >
        Most Common Numbers
      </h2>
      <div class="flex items-center justify-center p-10">
        <!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="UTF-8" />
            <meta
              name="viewport"
              content="width=device-width, initial-scale=1.0"
            />
            <title>Lottery Statistics</title>
            <!-- Include Tailwind CSS -->
            <link
              href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
              rel="stylesheet"
            />
            <link
              href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
              rel="stylesheet"
            />
          </head>
          <body class="bg-gray-100">
            <div class="container mx-auto p-6">
              <h1 class="text-3xl font-semibold mb-4">
                Lottery Number Statistics
              </h1>
              <!-- Add a container for displaying the statistics -->
              <div
                class="bg-white rounded shadow overflow-hidden"
                style="max-height: 600px; min-width: 600px; overflow-y: auto"
              >
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        onclick="sortTable(0)"
                        data-index="0"
                      >
                        Number
                        <span class="ml-2" id="sort-icon-0"></span>
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        onclick="sortTable(1)"
                        data-index="1"
                      >
                        Percentage of Times Drawn
                        <span class="ml-2" id="sort-icon-1"></span>
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        onclick="sortTable(2)"
                        data-index="2"
                      >
                        Times Drawn
                        <span class="ml-2" id="sort-icon-2"></span>
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        onclick="sortTable(3)"
                        data-index="3"
                      >
                        Last Drawn Date
                        <span class="ml-2" id="sort-icon-3"></span>
                      </th>
                    </tr>
                  </thead>
                  <tbody id="table-body">
                    <!-- Data will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>

            <script>
              // JavaScript to populate the table and enable sorting
              const tableBody = document.querySelector('tbody')
              const tableHeaders = document.querySelectorAll('th')
              let sortColumn = -1 // Default sorting column (none)
              let originalOrder = [] // Store the original order of items

              // Function to populate the table with data
              function populateTable(data) {
                tableBody.innerHTML = ''

                data.forEach((item) => {
                  if (item) {
                    const row = document.createElement('tr')
                    row.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap number-cell">
          <svg class="circular-ball" width="30" height="30" viewBox="0 0 30 30">
            <circle cx="15" cy="15" r="13" fill="#3d2645" />
            <text x="50%" y="50%" text-anchor="middle" dy="0.3em" fill="#fff" font-size="12">${item.number}</text>
          </svg>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="text-sm text-gray-900">${item.percentageOfDrawings}</div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="text-sm text-gray-900">${item.times}</div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="text-sm text-gray-900">${item.lastDrawnDate}</div>
        </td>
      `

                    tableBody.appendChild(row)
                  } else {
                    console.error('Invalid data item:', item)
                  }
                })
              }

              // a sort icon will be displayed next to the column name that is being sorted. if the column is sorted in ascending order, the sort icon will be an up arrow. if the column is sorted in descending order, the sort icon will be a down arrow. if the column is not sorted, the sort icon will be a horizontal line.

              // Function to update the sort icon
              function updateSortIcon(header, isAscending) {
                // Remove any existing sort icon
                const icon = header.querySelector('.sort-icon')
                if (icon) {
                  header.removeChild(icon)
                }

                // Create a new icon element
                const newIcon = document.createElement('i')
                newIcon.classList.add('sort-icon', 'fas', 'fa-sort')

                // Determine which icon class to add based on the sorting state
                if (sortColumn === header.cellIndex) {
                  if (isAscending) {
                    newIcon.classList.remove('fa-sort')
                    newIcon.classList.add('fa-sort-up')
                  } else {
                    newIcon.classList.remove('fa-sort')
                    newIcon.classList.add('fa-sort-down')
                  }
                }

                // Append the new icon to the header
                header.appendChild(newIcon)
              }

              // sort the table by a specific column when the header is clicked on. when the header is clicked on again, reverse the order. for example, if the heading Number is clicked on, the table will be sorted by number in ascending order. if Number is clicked on again, the table will be sorted by number in descending order. If the percentage of times drawn is clicked on, remove the percentage sign and sort by the number in ascending order, but keep the percentage sign in the table. If the percentage of times drawn is clicked on again, remove the percentage sign and sort by the number in descending order, but keep the percentage sign in the table. If the times drawn is clicked on, the table will be sorted by the times drawn in ascending order. If the times drawn is clicked on again, the table will be sorted by the times drawn in descending order. If the last drawn date is clicked on, use sortByDateAsc() function to sort the table by date in ascending order. If the last drawn date is clicked on again, use sortByDateDesc() function to sort the table by date in descending order.

              tableHeaders.forEach((header, index) => {
                header.addEventListener('click', () => {
                  if (sortColumn === index) {
                    // Reverse the order
                    originalOrder.reverse()
                  } else {
                    // Sort the data by the selected column
                    switch (index) {
                      case 0: // Number
                        originalOrder.sort((a, b) => a.number - b.number)
                        break
                      case 1: // Percentage of Times Drawn
                        originalOrder.sort(
                          (a, b) =>
                            a.percentageOfDrawings - b.percentageOfDrawings
                        )
                        break
                      case 2: // Times Drawn
                        originalOrder.sort((a, b) => a.times - b.times)
                        break
                      case 3: // Last Drawn Date
                        originalOrder.sort(
                          (a, b) =>
                            new Date(a.lastDrawnDate) -
                            new Date(b.lastDrawnDate)
                        )
                        break
                      default:
                        console.error('Invalid column index:', index)
                        break
                    }
                  }

                  // Update the sort column
                  sortColumn = index

                  // Update the sort icon
                  tableHeaders.forEach((header, i) => {
                    if (i === index) {
                      updateSortIcon(
                        header,
                        sortColumn === index && originalOrder[0].__index__ === 0
                      )
                    } else {
                      updateSortIcon(header, false)
                    }
                  })

                  // Populate the table with the sorted data
                  populateTable(originalOrder.map((item) => item))
                })
              })

              // Add the initial sort icon to each header
              tableHeaders.forEach((header) => {
                const icon = document.createElement('i')
                icon.classList.add('sort-icon', 'fas', 'fa-sort')
                header.appendChild(icon)
              })

              // Make an API request to fetch your statistical data from the server
              fetch('/getData/winningNumber/stats')
                .then((response) => {
                  if (!response.ok) {
                    throw new Error('Network response was not ok')
                  }
                  return response.json()
                })
                .then((statisticalData) => {
                  if (Array.isArray(statisticalData)) {
                    // Store the original order of the items
                    originalOrder = statisticalData.map((item, index) => ({
                      ...item,
                      __index__: index,
                    }))

                    // Populate the table initially
                    populateTable(statisticalData)
                  } else {
                    console.error('Invalid data format. Expected an array.')
                  }
                })
                .catch((error) => {
                  console.error('Error:', error)
                })
            </script>
          </body>
        </html>
      </div>
    </div>
    <!-- Footer -->
    <footer class="w-full">
      <div
        class="h-96 bg-cover bg-no-repeat bg-center relative"
        style="background-image: url('/assets/images/cloud3.svg')"
      >
        <div
          class="absolute inset-0 flex flex-col items-center justify-center text-center"
        >
          <div>
            <div
              class="grid grid-cols-4 gap-4 items-center justify-center"
              style="transform: translateY(150%)"
            >
              <div class="col-span-1">
                <!-- Your icon here -->
                <a
                  href="https://github.com/IndexDDuo/KnightHacks2023/tree/main"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="4em"
                    viewBox="0 0 496 512"
                  >
                    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                    <style>
                      svg {
                        fill: #000000;
                      }
                    </style>
                    <path
                      d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"
                    />
                  </svg>
                </a>
              </div>
              <div class="col-span-3">
                <div class="grid grid-cols-3 gap-4">
                  <div class="col-span-1">
                    <p class="text-xl font-semibold">Casandra Alvarez</p>
                    <p>
                      <a
                        href="https://github.com/ca764763"
                        class="text-jisoo hover:underline"
                        >GitHub</a
                      >
                    </p>
                    <p>
                      <a
                        href="https://www.linkedin.com/in/casandra-alvarez/"
                        class="text-jisoo hover:underline"
                        >LinkedIn</a
                      >
                    </p>
                  </div>
                  <div class="col-span-1">
                    <p class="text-xl font-semibold">Jing Li</p>
                    <p>
                      <a
                        href="https://github.com/IndexDDuo"
                        class="text-jisoo hover:underline"
                        >GitHub</a
                      >
                    </p>
                  </div>
                  <div class="col-span-1">
                    <p class="text-xl font-semibold">Lindsey Nielsen</p>
                    <p>
                      <a
                        href="https://github.com/lindsey-nielsen"
                        class="text-jisoo hover:underline"
                        >GitHub</a
                      >
                    </p>
                    <p>
                      <a
                        href="https://www.linkedin.com/in/lindsey-nielsen-97217b206/"
                        class="text-jisoo hover:underline"
                        >LinkedIn</a
                      >
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>
        var map = L.map('map').setView([28.5384, -82.3789], 6.5)
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
          attribution:
            '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        }).addTo(map)
        // var marker = L.marker([27.6648, 81.5158]).addTo(map)

        // Fetch the coordinates from coordinates.json
        fetch('/getData/coordinates')
          .then((response) => response.json())
          .then((data) => {
            // Loop through the array of coordinates and add markers to the map
            data.forEach((coord) => {
              L.circle([coord.lat, coord.lng], {
                color: 'red',
                fillColor: '#f03',
                fillOpacity: 0.5,
                radius: 3500,
              }).addTo(map)
            })
          })
          .catch((error) => console.error(error))
        var popup = L.popup()
          .setLatLng([28.6024, -81.2001])
          .setContent('You are here.')
          .openOn(map)
      </script>
    </footer>
  </body>
</html>
